---
title: "TER OVE 2017"
author: "Team Strange"
date: "16/03/2017"
output: html_document
---

```{r setup, include=FALSE}
library(ggplot2)
library(shiny)
setwd("/Users/Rico/GitHubs_Repo/ter-ove-2017/")
#donne <- read.csv(file="data.csv",head=TRUE,sep="\t")
knitr::opts_chunk$set(echo = TRUE)

```

on crée une fonction pourcentage afin de faciliter le calcule de pourcentage
```{r, echo=TRUE}

#numericInput("n", "How many cars?", 5) possibilité de choisir le nombre de données genere grace a shiny
#definition des functions d'aide pour le poucentage (formatage % + arondit avec 2 chiffre)
pourcentage<- function(tableau, sub){
#  pr<- paste(round((nrow(sub)*100)/nrow(tableau), digits = 2), "%")
  pr<- round((nrow(sub)*100)/nrow(tableau), digits = 2)
  return(pr)
}
```

Premièrement on génére des données aleatoires

```{r, echo=TRUE}
n<-200 #taille des donees a generer

# 18 mois
q4_3 <- sample(1:3, size=n, replace= TRUE) # Possède un emploi ou pas
q6_5 <- sample(1:13, size=n, replace= TRUE) # Type d'emploi
q6_6r<- sample(2:7, size=n, replace = TRUE) # Niveau d'emploi (ex: Cadre, Ingénieur, etc)
q6_7 <- sample(1:2, size = n, replace = TRUE) # Temps partiel ou pleins

# 30 mois
q7_1 <- sample(1:3, size=n, replace= TRUE) # Possède un emploi ou non
q8_1 <- sample(1:13, size=n, replace= TRUE) # Type d'emploi
q8_2r<- sample(2:7, size= n, replace = TRUE) # Niveau d'emploi (ex: Cadre, Ingénieur, etc)
q8_3<- sample(1:2, size = n, replace = TRUE) # Temps partiel ou pleins

# Data frame avec l'ensemble des donnees
universite <- data.frame(q4_3, q6_5, q6_6r, q6_7, q7_1, q8_1, q8_2r, q8_3)
head(universite, n=2)
```

On utilise subset afin de filtrer les données et travailler sur ceux qui ont un emploi

```{r, echo=TRUE}
insertion<-subset(universite, q4_3 == 1)
insertion2<-subset(universite, q7_1 == 1)
stable<-subset(insertion, q6_5 == 1 | q6_5 == 2 | q6_5 == 3)
stable2<-subset(insertion2, q8_1 == 1 | q8_1 == 2 | q8_1 == 3)
niveauEmploi<-subset(insertion, q6_6r == 2 | q6_6r == 4)
niveauEmploi2<-subset(insertion2, q8_2r == 2 | q8_2r == 4)
tempsPlein<-subset(insertion, q6_7 == 1)
tempsPlein2<-subset(insertion2, q8_3 == 1)
```

On formatte les données en data frame et on affiche les données
Une question se pose afin de savoir 
si la part des emplois cadre concerne l'ensemble de la population ayant un emploi  (total pouvant etre 80)
ou uniquement la part des cadres parmis la population comprenant les cares + profession intermediaire (sous population des 80, ex:30)
le pourcentage n'est pas le même si l'on etudie le pourcentage sur 80 que sur 30

```{r, echo=TRUE}
pourcentage18<-c(pourcentage(universite, insertion), pourcentage(insertion, stable), pourcentage(insertion, tempsPlein), pourcentage(insertion, niveauEmploi), pourcentage(insertion, subset(insertion, q6_6r == 2)))
pourcentage30<-c(pourcentage(universite, insertion2) ,pourcentage(insertion2, stable2),  pourcentage(insertion2, tempsPlein2), pourcentage(insertion2, niveauEmploi2), pourcentage(insertion, subset(insertion2, q8_2r == 2)))
df<-data.frame(pourcentage18, pourcentage30, row.names = c("Taux d'insertion","Part des emplois stable", "Part des emplois a temps plein", "Part des emplois de niveau cadre ou profession intermédiaire", "Part des emplois de niveau cadre"))
colnames(df) <-c("18 mois", "30 mois")
print(df)
```

On essaye de plot certaines données
```{r, echo=TRUE}

qplot(universite$q6_5, data = universite, bins=30, size = universite$q6_5)
ggplot(universite, aes(x = universite$q4_3)) + geom_bar()

qplot(x=df$`18 mois`,data= df, main="Univerité données a 18 mois", ylim=c(0, 50), xlim = c(0, 100), bins=30)

a<-ggplot(data = df, aes(x = df$`18 mois`, y = sum(df$`18 mois`)), bins=30)
a<- a+geom_count()
a<-a+xlab("Duree des emplois")+ylab("Total")+ggtitle("Test de plots des emploi stables a 18 mois")+scale_color_discrete(name = "Légende")
print(a)

```